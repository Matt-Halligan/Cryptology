##############################################
# Matthew Halligan
# Cryptology Summer 2025
# Module 8 Assignment 8, question 1b
# Professor Tom McGuire
#
# Compute the Exponentiation using the Square and Multiply Algorithm
# to produce an on-the-fly decoder
#
##############################################

def modular_exponentiation(base, exponent, modulus):
    z = 1
    # Process bits of c from most-significant down to least
    for bit in bin(exponent)[2:]:
        # square step
        z = (z * z) % modulus
        # multiply step if the current bit is 1
        if bit == '1':
            z = (z * base) % modulus

    #print(f"Exponentiation: {z}")
    return z

def decode(exponent, modulus, block_1):
    for first in range(26):
        for second in range(26):
            for third in range(26):
                base = ((26**2)*first)+(26*second)+(third)
                z = modular_exponentiation(base, exponent, modulus)
                if z == block_1:
                    print(f"Base: {base}={alphabet[first]}, {alphabet[second]}, {alphabet[third]}")
                    block = f"{alphabet[first]}{alphabet[second]}{alphabet[third]}"
                    return block
                #print(f"Exponentiation: {z}")
    if base == 17576 and z != block_1:
        print("Not found")
        
alphabet=['a','b','c','d','e','f','g','h','i','j','k','l','m','n','o',
          'p','q','r','s','t','u','v','w','x','y','z']
# print(len(alphabet))
exponent = 65537
modulus = 24645628578887483625214731150487059729886377365695683082631117428823619102729187176966689791950869524834448592870279224330227128884075914225523249167053845996665796306492716358617822164060064704987629828241441781706900555279154713591312454449866845394280401666459570355797899363683386939446138607468554793172253440430279805789269088752664557686223027523130880728976709028580830135440197380929411967009781325049205664536765310873276123076161430309122607795979618884228158133807901186458899848659224892492513933844642135370381627537078502380958355871581312215238082066932858596654235336069372185010511476316814702963339

#Blocks are the encrypted message
block_1 = 16588116854128760960513193733568130560104101337327304931276670359300494489834879903051282293563539380927432786990103373421640896732693678485478172087254492600787577248244445017483269443342235027251789566250097413907535148970531412051176703526272203929235238498259735356388457593019543840571759623954903047129617470746993487481392949771371468591268150401394228353192062243964166038435083562726145569484032442221311032359697684340758878377404362438517260321281660312198689589057210530924274526981473405633366467835897452725063698685140125114693467225742959304655825251033148598591719910106101007028218161313465322120056
block_2 = 3504299477784968615559579158434168486612660530744084725887824213059899831436488113266438730981861276960834372227313402810249249638821001268965985544966633004059217082948472992406669896274922576752721089478628560376029848338110500879861984527122536923899102361207491419314026650803541871680979271351108499783646334157216833133241629656286783251694142616849632045683968265066751263553711448255809722318161016129872725786712848038868639460830208321958854814424791466672758253184867840891266578581686322085013206026786783669972013404316211279268491990253672491610635706698586536866119860628050795379582298487255244924331
block_3 = 7934575163446574450951570088296748757258507549863524306839952287105062943669324315766210844394542501224826174892675664099071655958875654915373123249170641957983837931612722781808698704200932363681264162283081245843048485767334242440359347060325096404758497469431039600676436846747757975984709423359397899041086872533816381370529798195605088041154247921405407869677627214556290679315934020516623112272084086090821965241111590940932234860753020730192971469522171517568654116040946265288233948932014873842237558908324139723176502539711384256255205084390364691528315114623928923754388804521102314624266526358860655360704
block_4 = 13781591736970117118526403947353516724212717165809643607419401214384187632159407278311093351627971525981723048551814396608324905251229872822594495667715872955455926284501608714967347923147405418195772059911082103920507850344479446079902419048165702427838106198777859505968995241212588646664524329907235654318690893671341368812757713792329374714211504597417521120391431484016220465849242841675972184700466826835962720742316156537481731190576238867526960369774489910162683818006271114140408942742882917980832596628122280305065470520571796599151147373169226588554862966673218998927815300750783740158590117300793880171697
block_5 = 1564678715085873793184470114996286393202210025115788355388233125088216047909734430718142861632262908200162470543455308015575692684712116225218782203053772745366328758612118213588294888637597151292227259030818616410381132831082400118247896667990892217463433920706574851188754623575936031037071405124053228843096361216344714929744743147828890080937797230003457971554715580304174959482425946789027254888891129758612328348870918017382400390463626420103013281696942112401285318027279823223550420268057902225665616883028780643758394638541200312719129607439601489447326769706221432989563206356269739856212450300550942380200

string_output = ""
string_output += decode(exponent, modulus, block_1)
string_output += decode(exponent, modulus, block_2)
string_output += decode(exponent, modulus, block_3)
string_output += decode(exponent, modulus, block_4)
string_output += decode(exponent, modulus, block_5)
print(f"Decoded String: {string_output}")
